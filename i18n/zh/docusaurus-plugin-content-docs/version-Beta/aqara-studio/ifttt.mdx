# 标准 IFTTT

Aqara Studio 提供了标准的 IFTTT 流程，仅需配置“当-且-就”三个环节，即可快速编排自动化。

<img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/Automation-IFTTT.png" style={{ width: '80%' }} />   
## 新建自动化

如需了解如何新建 IFTTT，请参考 [自动化管理 - 新建自动化](./automation.mdx#新建自动化)。

## 设置自动化

请参阅下文，了解如何高效、便捷地设置 IFTTT 自动化流程。

### 1 配置当

**当**代表的是触发自动化的起点，即 Studio 监听的**设备事件**或**时间点**。Studio 会持续监听上述事件或时间是否发生，例如“监测到房间有人”、“监测到温度高于 28 摄氏度”等。

#### 添加触发条件

1. 单击**添加触发条件**。   

    <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-AddEvent.png" style={{ width: '80%' }} />   

2. 选择**设备**或**定时触发**。

    <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-EventTypes.png" style={{ width: '80%' }} />   

    - 单击**设备**后：
        1. 添加设备事件   
            在**设备**弹窗中选择需要的设备和需要的功能卡片后，单击**确认**。   
            <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-DevicePopup.png" style={{ width: '80%' }} />   

            此时，你可以在**当**区域看到了 Studio 将会在**一周七天 24 小时不间断**监听该设备事件的**默认值**。   
            <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-EventAdded.png" style={{ width: '80%' }} />   
        2. 修改监听目标值   
            如果你想监听设备事件的其他值，单击事件中的蓝色字样，即可修改。   
            <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-ModifyEventParameter.png" style={{ width: '80%' }} />   
        3. 添加时间限制
            您可以为监听添加两种时间限制，分别为监听生效时段和事件持续时长要求。
            - 设置监听生效时段   
                如需设置仅在特定日期和时间段监听事件，请点击 **... > 时段** 进行配置。   
                > **注意**
                > 
                > 时间范围选择 00:00:00-00:00:00 时，表示此逻辑全天生效。

                <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-SetEventTimePeriod.png" style={{ width: '80%' }} />   
            - 设置事件持续时长要求
                当您希望设备事件被检测到后，只有在该事件持续一定时长后才触发后续动作时，可单击 **... > 持续时长** 进行设置。    
                <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-SetEventDuration.png" style={{ width: '80%' }} />   
    - 单击**定时触发**后：
        1. 选择触发行为的日子（每周周几，可多选）。   
            <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-SetEventDate.png" alt="选择一周的某几天" style={{ width: '80%' }} />   
        2. 设定时间类型。   

            <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-SetTimeType.png" alt="选择时间类型" style={{ width: '80%' }} /> 

            :::tip
            
            选择日出或日落时，请输入您家庭的经纬度，格式如下：
            - 北纬、东经 → 使用正数（如：北纬 35.0° → `35.0`）
            - 南纬、西经 → 使用负数（如：西经 120.0° → `-120.0`）
            <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-PassInLongitudeandLatitude.png" alt="传入家庭的经纬度" style={{ width: '80%' }} />
            
            ::: 

        3. 设置时间。   

            <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-SpecifyTime.png" alt="设置具体时间点" style={{ width: '80%' }} />   

#### 选择条件满足逻辑

当您添加多个触发条件时，可以灵活设置这些条件的满足逻辑：
- **触发任一条件**：只要 Studio 检测到其中任意一个条件成立，即会触发后续动作。
- **按顺序依次触发**：只有当所有条件按照设定顺序依次被满足后，才会触发后续动作。

<img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-SelectEventLogic.png" alt="设置触发条件" style={{ width: '80%' }} />   

### 2 （可选）配置且

**且**区域用于添加额外的状态条件，以进一步精确控制自动化的触发。只有在**当**区域的条件已满足后，系统才会判断**且**区域中的条件，只有这些条件**全部或部分**满足时，自动化才会执行。

举例：你可以将“检测到房间有人”设置为**当**条件，同时在**且**中添加“空调为开启状态”。只有当房间有人且空调也处于开启时，才会执行后续动作。

#### 添加状态条件

1. 单击**添加状态条件**。

    <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-AddCondition.png" style={{ width: '80%' }} />   

2. 选择**设备**。   

    <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-AddConditionDevice.png" style={{ width: '80%' }} />   

3. 选择所需的**设备**及其对应的**功能卡片**，然后点击**确认**。  

    <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-SelectConditionFunction.png" style={{ width: '80%' }} />   

    添加完成后，你将在**且**区域看到已选设备条件，显示该条件的**默认状态**。   

    <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-ConditionAdded.png" style={{ width: '80%' }} />   

4. 修改条件判断的目标值    

   如需判断设备的其他状态或数值，点击条件中的蓝色字段，选择或输入你想要判断的目标值即可完成修改。   

   <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-ModifyConditionParameter.png" style={{ width: '80%' }} />   

5. 配置时间限制    
   可以为条件判断设置两类时间限制：一类是判断生效的时间段，另一类是事件需持续的最短时长。具体设置方法与“当”区域的操作一致，按照相同流程进行选择和修改即可。

#### 选择条件满足逻辑

当您添加多个状态条件时，可以灵活设定条件的判断方式（满足逻辑）：
- **满足所有条件**：所有状态条件均满足时，自动化才会被执行。
- **满足任一条件**：只要有一个状态条件满足，即可触发后续自动化动作。

<img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-SelectConditionLogic.png" alt="设置判断逻辑" style={{ width: '80%' }} />   

### 3 配置就

**就**区域用于配置自动化被触发后需要执行的具体操作。例如，可以让某个设备执行开关、调节数值等。除了设备动作之外，还可以在这里添加“延时”，并将延时操作穿插在各个设备动作之间，实现灵活的控制流程。

在**就**中，你可以添加多条执行动作，每条动作可独立设置其对应的设备及具体控制项。常见的执行动作包括：
- 控制设备的开关；
- 调节温度；
- 调整亮度；
- 插入延时步骤，让某些动作在指定延后时间后再执行。

配置完成后，所有在“就”区域设置的动作和延时将按顺序依次执行，实现更智能灵活的联动效果。

#### 添加执行条件

执行条件是指自动化触发后，需执行的设备动作或在动作间设置的延时步骤。

配置流程如下：
1. 单击**添加执行条件**。   

    <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-AddAction.png" style={{ width: '80%' }} />   

2. 选择**设备**或**延时执行**。 

    <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-SelectActionType.png" style={{ width: '80%' }} />   

3. 选择所需的**设备**及其对应的**功能卡片**，然后点击**确认**。  
    - 单击**设备**后：
        1. 添加设备动作   
            在**设备**弹窗中选择需要的设备和需要的功能卡片后，单击**确认**。   
            添加完成后，已选择的设备动作将在**就**区域显示，并预设为默认参数值，你可以根据实际需求进一步修改设置。    

            <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-ActionAdded.png" style={{ width: '80%' }} />   

        2. 修改动作参数   
            若需调整设备动作的具体参数，可点击动作中的蓝色字段，选择或输入所需的目标值进行设置。   

            <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-ModifyAction.png" style={{ width: '80%' }} />   

        3. 配置时间限制
            可以为动作执行设置生效的时间段，具体设置方法与“当”区域的操作一致，按照相同流程进行选择和修改即可。
    - 单击**延时**后：点击蓝色时长字段，即可修改延时时长。
    
        <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-DelayTimeSetting.png" style={{ width: '80%' }} />   
        :::tip
        **延时** 仅对它之后的设备动作生效。  
        例如：

        - 动作 A  
        - 延时  
        - 动作 B  

        上述流程中，当触发条件被满足时，Studio 会首先执行动作 A，随后等待设置的延时时长，再执行动作 B。延时是为了让动作 B 延后执行，动作 A 会立即执行，不受影响。

        如果执行条件如下：

        - 延时  
        - 动作 A  

        则当触发条件被满足后，Studio 会先等待设定的延时时长，然后再执行动作 A。
        :::

#### 选择执行逻辑

添加多个执行条件后，您可以灵活选择动作的执行方式：
- **执行全部**：每次满足触发条件时，Studio 会依次执行所有已设置的设备动作。
- **切换执行**：每次满足触发条件时，仅执行其中的一个设备动作，动作将按照设置的顺序轮流执行。每触发一次，执行下一个动作，循环往复。

<img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/zh/IFTTT-SelectActionLogic.png" alt="设置动作执行逻辑" style={{ width: '80%' }} />   

### 4 测试自动化

配置完上述条件后，单击**测试**按钮，即可检测你的自动化。

### 5 保存

当您确定自动化配置可行，效果符合预期时，即可单击**保存**。此时您可以在**自动化管理**页面看到新增的 IFTTT（默认已启用）。