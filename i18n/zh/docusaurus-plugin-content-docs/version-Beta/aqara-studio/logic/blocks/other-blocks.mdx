# 其他

## 工具批次设置

#### 功能概述

工具批次设置逻辑块用于同时设置多个功能点的值，适合批量参数配置与设备调试场景。您可一次性输入最多8个不同的数值，通过对应输出点分别下发至目标功能点。仅当“操作”字段传入OK时，本次批量设置才会生效，有效防止误操作，提升批量配置的效率与准确性。

#### 参数说明

- **输入A ~ 输入H**：输入待设置的数值。  
    - 可直接填写，也可通过左侧连接常量、变量或其他逻辑块的输出。  
    - 默认数据类型为 Number，如需修改类型，可双击逻辑块顶部进入设置页面，并在对应输入项处编辑 type。  
- **输出A ~ 输出H**：对应输出端口，将每个输入的值分别传递到目标功能点或逻辑块。  
    - 输入输出一一对应，例如输入A的值会通过输出A输出。  
- **操作**：控制批量设置的触发条件，仅当传入 `OK` 时批量设置生效，用于避免误操作。 

#### 示例

以“同时设置多个灯泡不同亮度”为例，操作步骤如下：

1. 在画布右侧添加需要控制的多个灯泡亮度功能点，例如“灯泡1 - 亮度”、“灯泡2 - 亮度”、“灯泡3 - 亮度”、“灯泡4 - 亮度”等。
2. 添加一个**工具批次设置**逻辑块。
3. 设置输入 A 为 20，输入 B 为 40，输入 C 为 60，输入 D 为 80.
4. 将输出 A、B、C、D 的右侧分别连接至上述灯泡亮度功能点的“输入”，
4. 设置**操作**参数为 `OK`，即可批量设置多个灯泡的亮度，实现灯泡1亮度为20、灯泡2亮度为40、灯泡3亮度为60、灯泡4亮度为80。

## 最小最大平均值

#### 功能概述

该逻辑块可用于对多个输入数值进行统计，自动计算其中的最小值、最大值和平均值。

#### 数据类型

本逻辑块默认展示的属性：
- **输入A ~ B**：你可以设置 2 个数值。
- **最小值**：输出所有有效输入中的最小值。
- **最大值**：输出所有有效输入中的最大值。
- **平均值**：输出所有有效输入的平均值。

如需在此逻辑块上显示更多“输入”端口，可双击进入配置面板，在附加输入项的 Flags 中勾选“显示”，确认后即可在编辑器中看到新增的输入端口。

## 随机

#### 功能概述

通过此逻辑块，您可以获得一个随机数。

#### 数据类型

- **偏移量**：指定生成随机数的最小起点，随机结果不会小于该值。默认值为 50。
- **乘数**：决定随机数的浮动区间。实际随机数范围为 `(偏移量, 偏移量 + 乘数)`。例如：若偏移量为 50，乘数为 100，则结果范围为 (50, 150)。
- **更新间隔**：控制随机数生成的频率。设置为 1 秒时，每秒会输出一个新的随机数。
- **输出**：输出当前生成的随机数，可连接到需要使用该数值的逻辑块或功能点。

## 计数器

#### 功能概述

计数器是一个用于累计计数的逻辑块，支持递增计数、递减计数、预设值和清零等操作。适用于各种需要统计次数或累计数值的场景。

应用场景：
- 人数统计：统计进出门的人数。
- 设备计数：记录设备开关次数、运行次数。
- 限次控制：达到指定次数后触发特定动作。

#### 数据类型

本逻辑块默认显示以下属性：
- **输出**：输出累计的计数值。
- **向上计数**：可连接功能点的输出或 [逻辑卡片](./logic-blocks.mdx) 的输出，每当输出结果发生变化时，计数值递增。
此外，您可以双击逻辑块，自定义并配置以下扩展属性：
- **预设值**：设置计数器的初始值。
- **计数增量**：设置每次“向上计数”或“向下计数”时，计数变化的步进值。
- **向下计数**：可连接功能点的输出或 [逻辑卡片](./logic-blocks.mdx) 的输出，每当输出结果发生变化时，计数值递减。
- **预设**：可连接功能点的输出或 [逻辑卡片](./logic-blocks.mdx) 的输出，每当输出结果发生变化时，计数器的当前值重置为“预设值”。
- **清除**：可连接功能点的输出或 [逻辑卡片](./logic-blocks.mdx) 的输出，每当输出结果发生变化时，计数器归零。

#### 使用方法

计数器的常见用法包括：
- **变化触发计数**：每当监听的功能点数值发生任意变化，即计数加一，适合统计事件总次数。即可直接将功能点的输出直接连接至此逻辑块。
- **条件触发计数**：仅在功能点的值满足特定条件（如等于某个值）时才计数，通常需配合 [逻辑卡片](./logic-blocks.mdx)，可实现有条件的计数需求。

#### 示例

**变化触发计数**   

以统计某设备开关总变动次数为例：

1. 在画布左侧添加“设备 - 开关状态”功能点。
2. 拖入一个**计数器**逻辑块，将“设备 - 开关状态”的输出连接至计数器的“向上计数”输入点。
3. 计数器的“输出”即为该开关发生开关变化的累计次数。

**条件触发计数**

以统计灯光被点亮（开）次数为例：

1. 添加“灯光 - 开关”功能点.
2. 在画布上添加一个 [等于](./logic-blocks.mdx#等于) 逻辑块。将等于逻辑块的“输入 A”与上述“灯光-开关”功能点的输出相连，将其“输入 B”设置为“1”（表示灯亮）。
2. 双击等于逻辑块，打开设置面板，在`满足`属性的`Flags`中勾选“显示”，以便在逻辑块上展示该属性。
3. 拖入一个**计数器**逻辑块，将上述`满足`的右侧端点连接至计数器的“向上计数”输入点。
4. 计数器的“输出”即为灯光被点亮的总次数，仅在灯亮时才计数。

## 循环执行

#### 功能概述

当您希望重复执行某个行为时，可使用此逻辑块实现循环控制，灵活构建定时循环的自动化流程。

#### 数据类型

默认显示的参数：
- **每次**：右侧端点连接循环目标功能点。
- **激活**：左侧端点连接触发循环的布尔型数据。

如需配置更多参数，可双击进入配置面板，可供配置的参数如下：
- **每**：在此设置每次动作执行的间隔，单位为秒。
- **首次执行前等待**：首次执行前的等待时长，单位为毫秒。循环开始后，将先等待此时长再首次执行目标行为，后续每轮等待时间则以“每次”为准。合理设置该参数可避免设备争抢资源或多组循环同时启动，适合设备初始化预热、错峰启动等场景。单位为毫秒。

#### 示例

下面以“当检测到有人时，每隔1小时自动设置空调为制冷26℃、自动风速”为例，说明具体配置步骤：

1. 在画布左侧添加 “人体传感器 - 存在状态” 作为循环的触发条件，右侧依次添加 “空调 - 模式”、“空调 - 温度” 和 “空调 - 风速” 等目标功能点。
2. 拖入一个**循环执行**逻辑块并放置于它们之间。
3. 双击该逻辑块，设置**每**为 `3600` 秒，实现间隔1小时的自动调节。
4. 如需首次循环执行延迟，可在“首次执行前等待”中设置时长（如 30000 毫秒，即 30 秒）。
5. 将“人体传感器 - 存在状态”输出（布尔型数据）连接至**循环执行**逻辑块的“激活”端口，确保自动化只有在房间有人时持续运行。
6. 双击循环执行块，打开设置面板，在`每次`参数的`Flags`中勾选“允许多个目标连接”，以便一次操作多个功能点。
7. 将“每次”输出端连接到“空调 - 模式”、“空调 - 温度”、“空调 - 风速”等目标功能点的输入。
8. 对每条连接线分别双击，找到“转换器 - 目标值”，取消勾选原有状态值，自定义要下发的目标值。例如：为空调模式设置“制冷”，温度设置为“26”，风速设置为“自动”。

通过上述配置，即可实现房间存在人员时，空调每隔1小时自动调整至指定状态，提升自动化体验和节能效果。