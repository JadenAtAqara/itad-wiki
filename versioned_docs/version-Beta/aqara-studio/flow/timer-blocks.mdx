# Timer Blocks

> **Note**
>
> Screenshots in this guide may look slightly different from what you see on your device. Please follow the actual interface for reference.

## Overview

Timer blocks let you precisely control when actions happen in your automation flows.

You can use timer blocks to:
- Trigger actions at a [specific time](#time-trigger) or [within a time period](#time-period)
- [Delay the next step](#delay)
- [Transform a transient state into a time interval](#state-duration)
- [Trigger an action only after several other actions have finished in order](#event-queue)

Here are the timer blocks available:

<img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-Total.png" alt="Timer block overview" style={{width: '80%'}} />  

## Time Trigger

### Feature

Use the **Time Trigger** block when you want an action to happen at a specific time.

### Components

<img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-FixedTimeCardIntro.png" alt="Time Trigger block" style={{width: '80%'}} />  

This block is a **single-output block** with three parameters:

| Parameter / Connection Point | Required | Description |
| -- | -- | -- |
| Weekday | ✔ | Choose which days of the week the action should be triggered. You can select multiple days. |
| Time Format | ✔ | Choose from <code>Specified Time</code>, <code>Sunrise</code>, or <code>Sunset</code>. |
| Time | ✔ | The meaning of this field depends on the "Time Type":<ul><li>If you select <code>Specified Time</code>, enter the exact time (24-hour format).</li><li>If you select <code>Sunrise</code> or <code>Sunset</code>, enter a relative time (for example, "15 minutes before").</li></ul> |
| Output Point | ✔ | Connect this to the action you want to trigger. |

### How to Use

Here’s how to set up a Time Trigger block:

1. **Select the days of the week** when you want the action to run (you can pick more than one day).
   
    <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-SelectDate.png" alt="Select days of the week" style={{width: '80%'}} />  

2. **Choose the time type**.

    <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-SelectTimeType.png" alt="Select time type" style={{width: '80%'}} />  

    > **Note**
    >
    > If you choose `Sunrise` or `Sunset`, you’ll need to enter your home’s latitude and longitude:
    > - North latitude and east longitude: use positive numbers (e.g., North 35.0° → `35.0`)
    > - South latitude and west longitude: use negative numbers (e.g., West 120.0° → `-120.0`)
    > <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-PassInLongitudeandLatitude.png" alt="Enter latitude and longitude" style={{width: '80%'}} />  

3. **Set the time**.
   
    <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-SpecifyTime.png" alt="Set the specific time" style={{width: '80%'}} />  

4. **Connect the output** on the right side of the block to the action you want to trigger.

    <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-ConnectionToFixedTimeAction.png" alt="Connect to the next action" style={{width: '80%'}} />  

## Time Period

### Feature

This block sets up a rule: a subsequent action runs only when the previous one has occurred during the specified time period.

### Components

<img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-TimeWindowIntro.png" style={{width: '80%'}} />  

This block is a **dual-point block** with three parameters:

| Connection Point / Parameter | Required | Description |
| -- | -- | -- |
| Input Point | ✔ | Connect to an [Event](./device-blocks.mdx#event) block). |
| Weekday | ✔ | Select the days when this logic works. You can select multiple days. |
| Start Time | ✔ | Start time (24-hour format). |
| End Time | ✔ | End time (24-hour) format. |
| Output Point | ✔ | Connect to the action you want to trigger. |

### How to Use

Here's how to set up a Time Period block:

1. **Select the days of the week** when you want the action to run (you can pick more than one day).
    <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-SelectDateforTimePeriod.png" alt="Select days of the week" style={{width: '80%'}} />  
2. **Set the time period**.
   > **Note**
   >
   > When you set the time period to 00:00:00-00:00:00, the action will be active all day.
   
    <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-SetTimeRange.png" alt="Set time period" style={{width: '80%'}} />  
3. **Connect  the input** on the left side of the block to an event block.    
   This means the follow-up action will only be triggered if the event occurs within the specified days and time period.  
   <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-EventConnectedToTimeWindow.png" alt="Connect an Event block" style={{width: '80%'}} />    
4. **Connect the output** on the right side of the block to the action you want to trigger.
    <img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-ConnectionToActionForTimeWindow.png" alt="Connect to the next action" style={{width: '80%'}} />  

## Delay

### Feature

Use the **Delay** block when you want to wait for a specified amount of time after one step completes before triggering the next step.

You can use this block in the following scenarios:
- **Debounce Processing**: To prevent false triggers caused by frequent sensor signal fluctuations.
- **Delayed Response**: To execute a follow-up action after waiting for a certain amount of time once an event occurs.
- **Timed Linkage**: For example, to automatically turn off the light 30 seconds after the door opens.

### Components

<img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-DelayBlockIntro.png" alt="Delay block introduction" style={{width: '80%'}} />  

This block is a **dual-point block** with one parameter:

| Connection Point / Parameter | Required | Description |
| -- | -- | -- |
| Input Point | ✔ | Connect to the previous step. |
| Delay Duration | ✔ | Delay duration, supports seconds, minutes, or hours. |
| Output Point | ✔ | Connect to the step that will be triggered after the delay. |

### How to Use

<img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-Delay.png" alt="Delay block example" style={{width: '80%'}} />  

Here's how to set up a Delay block:

1. **Connect the first step** to the left side of the block.
2. **Connect the second step** to the right side of the block.
3. **Set the delay duration**.

## State Duration

### Feature

The **State Duration** block has two main uses:
- **Delayed parameter modification**: Automatically modify device boolean parameters within a specified time after an event or state occurs.
- **Extend transient states**: Transform a transient event or state into a time interval with duration, which can be used for logical operations (AND/OR) on multiple states and trigger subsequent steps based on the operation results.

### Components

<img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-StateDurationIntro.png" style={{width: '80%'}} />  

This block is a **dual-point block** with one parameter:

| Connection Point / Parameter | Required | Description |
| -- | -- | -- |
| Input Point | ✔ | Connect to the event or state that needs to be monitored ([Event](./device-blocks.mdx#event) block. |
| Duration | ✔ | State duration, supports seconds, minutes, or hours. |
| Output Point | ✔ | Based on usage, supports connecting to the following blocks:<ul><li>Modify device boolean parameters: <a href="./variables-blocks.mdx#point-data">Point Data</a></li><li>Logical operations: <a href="./logic-blocks.mdx#and">AND</a></li></ul> |

### How to Use

#### Modify Device Boolean Value

<img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-StateDuration.png" alt="Device state duration example" style={{width: '80%'}} />  

The above example shows how `State Duration` is used to modify device boolean values:
- Two motion sensors are installed in the room. If either sensor detects motion, the `State Duration` block is activated and outputs `true` to the light switch block.
- Each time a sensor detects motion again, the "existence" duration is automatically extended by 10 minutes, keeping the light on.
- If no sensors detect motion during this period, after the 10-minute countdown ends, the State Duration block outputs `false` and the light turns off.

Steps:
1. Connect the `Event` block to the left side of the State Duration block (in the image, those are 2 motion sensors' existence block).
2. Set the state duration (supports seconds, minutes, or hours).
3. Connect the boolean `Point Data` block to the right side of the State Duration block (in the image, this is a light bulb's switch state).

#### Control Devices Based on Logical Operation Results

<img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-StateDurationAnd.png" alt="Device state duration with logic" style={{width: '80%'}} />  

The diagram shows two scenarios where the **Aqara Smart Dimmer Controller T1** automatically adjusts the brightness to 30%:
- The **Aqara LED Light T1** turns on within 1 minute after the** Aqara Smart Dimmer Controller T1** is switched on.
- The **Aqara Smart Dimmer Controller T1** is switched on within 30 seconds after the **Aqara LED Light T1** turns on.

Steps:
1. Add 2 or more "Event-State Duration" flows.
2. Connect the above flows to an `AND` block.
3. Connect the output point of the `AND` block to [Action](./device-blocks.mdx#action) blocks.


## Event Queue

### Feature

Use the **Event Queue** block when you want to define a series of events that should occur in a specific time sequence to trigger subsequent steps. For example, if an indoor motion sensor detects someone within 10 seconds after a door lock is unlocked, trigger the air conditioner to turn on.

### Components

<img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-SequenceBlockIntro.png" alt="Event queue block components" style={{width: '80%'}} />  

This block is a **multi-point block** with one add button and one configuration parameter:

| Connection Point / Parameter | Required | Description |
| -- | -- | -- |
| Event 1 (Input Point) | ✔ | It represents event sequence 1, and timing starts from this event. It usually connects to [Event](./device-blocks.mdx#event) block, but can also connect to [Condition](./device-blocks.mdx#condition) block |
| Event 2 (Input Point) | ✔ | It represents event sequence 2, and connects to [Event](./device-blocks.mdx#event) block |
| Add Button | ✘ | It is used to add more input points to connect more events. |
| Interval Duration | ✔ | It specifies the interval duration, supports seconds, minutes, or hours. |
| True (Output Point) | ✔ | It connects to [Action](./device-blocks.mdx#action) block as the subsequent triggered behavior. |

### How to Use

<img src="https://itad-aqara-docs-1300889962.aqara.com/dev/img/aqara-studio/en/TimeBlock-SequenceSteps.png" alt="Event queue example" style={{width: '80%'}} />  

The above example shows that when the Aqara LED Light T1 is turned on, if the Aqara Smart Dimmer Control is also turned on within 1 minute, then adjust the Aqara Smart Dimmer Control's brightness to 50.

Steps:
1. Connect different `Event` blocks to the input points on the left side of the `Event Queue` block in sequence (in the image, these are the switch state blocks for Aqara LED Light T1 and Aqara Smart Dimmer Control).
2. Set the interval duration.
3. Connect `Action` blocks to the output point on the right side of the `Event Queue` block (in the image, this is the brightness adjustment block for Aqara Smart Dimmer Control).

